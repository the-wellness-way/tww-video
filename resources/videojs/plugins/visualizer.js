/**
 * @license
 * Copyright (c) 2024 The Nuevodebel Team. All rights reserved.
 * Visualizer Plugin for video.js Version 1.0
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(this,e,e.videojs)):"undefined"!=typeof module&&module.exports?module.exports=t(e,e.videojs):t(e,e.videojs)}(window,function(e,t){"use strict";function i(i,o){var r,n=i.el(),a=i.$(".vjs-tech"),l={video:!1,color1:"#ffcc00",color2:"#ff0000",capsColor:"#fff",caps:!1,bottom:0,height:50,f_play:!1};try{r=t.obj.merge(l,o||{})}catch(e){r=t.mergeOptions(l,o||{})}if(1==(e.AudioContext=e.AudioContext||e.webkitAudioContext,!!e.AudioContext)){var s,c,d,u,f,h,p,m,v=!0,y=new WeakMap,g="50",w="0";parseInt(r.height)>0&&parseInt(r.height)<=100&&(g=parseInt(r.height)),parseInt(r.bottom)>0&&(w=parseInt(r.bottom)+"%");parseInt(r.width)<=100&&parseInt(r.width)>10&&(100-parseInt(r.width))/2;var A=".vjs-visualizer{left:0;z-index:4;position:absolute;padding:0 10px;bottom:"+w+";width:100%;height:"+g+"%;pointer-events:none;}";return i.on("playerresize",function(){S()}),function(e){var t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}(A),(d=document.createElement("canvas")).className="vjs-visualizer",d.id="visualizer",n.insertBefore(d,i.controlBar.el_),S(),i.ready(function(){s=!1,i.on("loadeddata",function(){var e=i.currentType();s=e.indexOf("audio")>-1,r.f_play=!1,r.video&&(s=!0)}),i.on("playing",function(){if(!r.f_play){void 0!==i.currentSource().av&&(v=!1);n.querySelector(".vjs-background-bar");if(r.f_play=!0,s&&v){!function(){a=i.$(".vjs-tech");try{null==c&&(c=new AudioContext),y.has(a)?p=y.get(a):(p=c.createMediaElementSource(a),y.set(a,p)),m=c.createAnalyser(),d.width=d.offsetWidth,d.height=3*d.height,h=d.getContext("2d"),p.connect(m),m.connect(c.destination)}catch(e){}}();function t(e,t){e=e.replace("#","");var i=parseInt(3==e.length?e.slice(0,1).repeat(2):e.slice(0,2),16),o=parseInt(3==e.length?e.slice(1,2).repeat(2):e.slice(2,4),16),r=parseInt(3==e.length?e.slice(2,3).repeat(2):e.slice(4,6),16);return t?"rgba("+i+", "+o+", "+r+", "+t+")":"rgb("+i+", "+o+", "+r+")"}r.color1.indexOf("#")<0&&(r.color1="#"+r.color1),r.color2.indexOf("#")<0&&(r.color2="#"+r.color2);var o="#ffcc00",l="#ff0000",g="#fff",w=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i;w.test(r.capsColor)&&(g=r.capsColor),w.test(r.color1)&&(o=r.color1),w.test(r.color2)&&(l=r.color2);var A=t(o),S=t(l),b=t(o,.2),q=new Array;function j(){if(s){a=i.$(".vjs-tech");var t=n.querySelector(".vjs-background-bar");t&&(t.style.display="none"),m.fftSize=256,u=m.frequencyBinCount,d.width=n.offsetWidth-20;var o=d.width/u*1.2;o<6&&(o=6);var l,c=1;d.width<500&&(c=2),e.RequestAnimationFrame=e.requestAnimationFrame(j)||e.msRequestAnimationFrame(j)||e.mozRequestAnimationFrame(j)||e.webkitRequestAnimationFrame(j);var p=0;f=new Uint8Array(u),m.getByteFrequencyData(f),h.clearRect(0,0,d.width,d.height);for(var v=0;v<u;v+=c)if(v=parseInt(v),l=f[v],p+o<d.width){var y=h.createLinearGradient(0,0,0,.5*d.height);y.addColorStop(1,A),y.addColorStop(.5,S),y.addColorStop(0,S);var w=d.height/1.5-l,x=d.height/1.5;h.fillStyle=y,h.fillRect(p,w,o,l),r.caps&&(q[p]?(h.fillStyle=g,w<q[p]?(q[p]=w,w!=x&&h.fillRect(p,w-6,o,3)):(q[p]=q[p]+1,q[p]<x&&h.fillRect(p,q[p]-6,o,3))):q[p]=w),h.fillStyle=b,h.fillRect(p,d.height/1.5,o,l/2),p+=o+4}}else try{h.clearRect(0,0,d.width,d.height)}catch(e){}}e.RequestAnimationFrame=e.requestAnimationFrame(j)||e.msRequestAnimationFrame(j)||e.mozRequestAnimationFrame(j)||e.webkitRequestAnimationFrame(j)}}})}),this}function S(){i.el_.offsetWidth;var e,t=i.el_.querySelector(".vjs-visualizer"),o=i.el_.querySelector(".vjs-control-bar"),r=t.offsetHeight,n=parseInt(getComputedStyle(o).getPropertyValue("height"));n+=o=parseInt(getComputedStyle(o).getPropertyValue("bottom"));var a=10;i.el_.querySelector(".vjs-skin-treso")&&(a=20),i.el_.querySelector(".vjs-skin-mockup")&&(a=30),i.el_.querySelector(".vjs-skin-jwlike")&&(a=15),e=n-r/3+a,t.style.bottom=e+"px"}}e.videojs_visualizer={version:"0.2"};t.registerPlugin||t.plugin;t.registerPlugin("visualizer",function(e){this.ready(function(){i(this,e)})})});
